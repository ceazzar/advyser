# Advisor Verification System (AU)

Complete specification for advisor claim, verification, and ongoing re-verification.

---

## Part 1: Claim and Initial Verification

### 1) Core Data Objects

#### Business (real-world entity)

* `business_id`, `trading_name`, `legal_name`, `abn`, `acn` (optional)
* `addresses[]`, `phone`, `website`
* `claimed_status`: `unclaimed | pending | claimed`
* `verification_level`: `none | basic | licence_verified | enhanced`

#### ClaimRequest

* `claim_request_id`, `business_id`, `requester_user_id`
* `submitted_fields` (ABN, licence numbers, etc.)
* `evidence_files[]`
* `status`: `pending | needs_more_info | approved | denied`
* `review_notes`, `reviewed_by`, timestamps

#### Credentials (multi-regime)

A single, flexible table:

* `credential_type`:
  * **Financial advice**: FAR (relevant provider), AFS licence, Authorised Representative
  * **Credit/mortgage**: Australian Credit Licence (ACL), Credit Representative
  * **Property**: state real estate / land agent / buyer's agent licence/registration
* `credential_number`, `name_on_register`, `state`, `expiry` (if applicable)
* `verification_status`: `unverified | pending | verified | rejected`
* `verification_source`: `asic_register | state_register | document_only`
* `verified_at`, `verified_by`

---

### 2) Verification Levels

#### Level 0 — Unverified

* Listing exists (maybe imported/seeded), but no proof

#### Level 1 — Basic Verified

Requirements:

* Email + phone verified
* ABN verified (business exists + matches name) via ABN Lookup / ABR data
* Proof of control of business contact method:
  * OTP to listed business phone **or**
  * DNS / email domain verification **or**
  * "Add a code to your website footer" (like GSC-style)

#### Level 2 — Licence Verified

Requirements depend on advisor type, using **public registers**:

**Financial advisers**
* Match adviser on ASIC-managed Financial Advisers Register (MoneySmart)

**AFS authorised reps / licensees**
* Match on ASIC Professional Registers / AR Register

**Mortgage / credit**
* Confirm covered by an Australian credit licence / credit activity coverage

**Property / buyer's agent / real estate**
Verify using the appropriate state public register:

* NSW: Service NSW licence check
* VIC: Consumer Affairs Victoria estate agents register
* QLD: "Check a property licence" register
* WA: Consumer Protection licence search
* SA: CBS / land agent licence holder search

#### Level 3 — Enhanced (optional later)

* Identity verification (KYC) for the claimant
* Extra checks for high-risk categories
* Ongoing monitoring / re-verification cadence

---

### 3) Claim Flow (MVP)

#### Step 1 — Claim Entry Point

From a listing page: **"Claim this business"**

User picks:
* "I'm the owner/principal"
* "I work here (staff)"

#### Step 2 — Provide Claim Data

**Everyone**
* ABN (or ACN)
* Role/title
* Business email + phone
* Service areas

**Financial advice track**
* Adviser name + FAR link or identifier
* AFS licence number (if licensee) or AR details (if rep)

**Mortgage/credit track**
* ACL number or credit rep details

**Property track**
* State + licence/registration number

#### Step 3 — Proof of Control

Choose one:
1. OTP to business phone listed on the profile/ABN record
2. Verify email domain (e.g., *@business.com.au*)
3. Website verification code

#### Step 4 — Evidence Upload

* Screenshot/PDF of licence card / certificate
* Letter of authority (if staff claiming)
* Optional: ASIC/MoneySmart profile link(s)

#### Step 5 — Status = Pending

Admin review queue created automatically.

---

### 4) Admin Review Workflow

#### Admin Screen Shows

* Claimant user identity + verification (email/phone)
* Submitted ABN and ABR match result
* Licence checks:
  * ASIC PRS search results
  * MoneySmart FAR listing for advisers
  * State licence register link-outs for property
* Evidence files

#### Admin Decisions

* **Approve** → business becomes claimed, requester assigned as `owner`
* **Needs more info** → request specific missing field / proof
* **Deny** → record reason + lockout rule if malicious

---

### 5) Anti-Fraud Measures

#### Claim Fraud Prevention
* **One business = one owner** (initially). Staff must be invited by owner later.
* Require proof-of-control step before admin reviews.
* Rate-limit claim attempts per user/IP/device fingerprint
* Block disposable email domains for claimants

#### Impersonation Detection
* Flag if claimant email domain ≠ business domain and no phone/website proof
* Flag if ABN entity name mismatch is high
* Flag if claimant tries to claim multiple unrelated businesses quickly

#### Review Fraud Prevention
* Only allow reviews linked to a **Lead/Booking** record ("verified engagement")
* Delay review eligibility until lead status = `completed` or `converted`
* Abuse monitoring: many reviews from same IP/device, unusual timing bursts

---

## Part 2: Re-Verification and Stale Data

### Goals

- Keep "Verified" badges meaningful and current
- Avoid stale register claims that could mislead consumers
- Maintain transparency: show "Verified on <date>" to build trust
- Comply with AU regulatory expectations

---

### Re-Check Cadence

┌─────────────────────────┬─────────────────────┬─────────────────────────────────┐
│     Credential Type     │ Re-check Frequency  │             Notes               │
├─────────────────────────┼─────────────────────┼─────────────────────────────────┤
│ ABN (via ABR)           │ Every 90 days       │ Or on profile edits             │
├─────────────────────────┼─────────────────────┼─────────────────────────────────┤
│ AFSL / ACL (business)   │ Every 180 days      │ Licences rarely change          │
├─────────────────────────┼─────────────────────┼─────────────────────────────────┤
│ FAR entries (advisers)  │ Quarterly           │ Aligned to ASIC update cycles   │
├─────────────────────────┼─────────────────────┼─────────────────────────────────┤
│ Credit Representative   │ Every 180 days      │                                 │
├─────────────────────────┼─────────────────────┼─────────────────────────────────┤
│ State real estate       │ Every 180 days      │ State registers vary            │
├─────────────────────────┼─────────────────────┼─────────────────────────────────┤
│ Expiring licences       │ 30 days before      │ Then weekly until resolved      │
└─────────────────────────┴─────────────────────┴─────────────────────────────────┘

**User-Triggered Refresh**
- Advisor can request "Re-verify my credentials" from dashboard
- Useful after licence renewal or register update
- Rate-limited to 1 request per 7 days per credential

---

### Register Sources (AU)

**Financial Services**

┌──────────────────────────────┬──────────────────────────────────────────┬─────────────┐
│         Credential           │                  Source                  │ Automation  │
├──────────────────────────────┼──────────────────────────────────────────┼─────────────┤
│ Financial Advisers (FAR)     │ MoneySmart Financial Advisers Register   │ Semi-auto   │
├──────────────────────────────┼──────────────────────────────────────────┼─────────────┤
│ AFSL Holders                 │ ASIC Professional Registers              │ Semi-auto   │
├──────────────────────────────┼──────────────────────────────────────────┼─────────────┤
│ Authorised Representatives   │ ASIC PRS                                 │ Semi-auto   │
└──────────────────────────────┴──────────────────────────────────────────┴─────────────┘

**Credit/Mortgage**

┌──────────────────────────────┬──────────────────────────────────────────┬─────────────┐
│         Credential           │                  Source                  │ Automation  │
├──────────────────────────────┼──────────────────────────────────────────┼─────────────┤
│ Australian Credit Licence    │ ASIC Credit Licensee Search              │ Semi-auto   │
├──────────────────────────────┼──────────────────────────────────────────┼─────────────┤
│ Credit Representatives       │ ASIC PRS                                 │ Semi-auto   │
└──────────────────────────────┴──────────────────────────────────────────┴─────────────┘

**Property (State-Based)**

┌─────────┬─────────────────────────────────────┬─────────────┐
│  State  │               Source                │ Automation  │
├─────────┼─────────────────────────────────────┼─────────────┤
│ NSW     │ Service NSW Licence Check           │ Manual      │
├─────────┼─────────────────────────────────────┼─────────────┤
│ VIC     │ Consumer Affairs Victoria           │ Manual      │
├─────────┼─────────────────────────────────────┼─────────────┤
│ QLD     │ QLD Property Licence Check          │ Manual      │
├─────────┼─────────────────────────────────────┼─────────────┤
│ WA      │ WA Consumer Protection              │ Manual      │
├─────────┼─────────────────────────────────────┼─────────────┤
│ SA      │ CBS SA                              │ Manual      │
└─────────┴─────────────────────────────────────┴─────────────┘

---

### Stale Data Handling

**Badge States**

┌────────────────────────────────┬────────────────────────────┐
│             State              │       Badge Display        │
├────────────────────────────────┼────────────────────────────┤
│ Verified (current)             │ ✓ Verified                 │
├────────────────────────────────┼────────────────────────────┤
│ Verification pending refresh   │ ⏳ Verification updating   │
├────────────────────────────────┼────────────────────────────┤
│ Overdue (> 30 days)            │ ⚠️ Verification pending    │
├────────────────────────────────┼────────────────────────────┤
│ Rejected/Expired               │ No badge (or ✗ if needed)  │
└────────────────────────────────┴────────────────────────────┘

**Soft Stale (Overdue < 30 days)**
- Badge changes to "Verification updating"
- No ranking penalty yet
- Admin task created with high priority

**Hard Stale (Overdue > 30 days)**
- Badge downgraded to "Verification pending"
- Ranking penalty applied
- Advisor notified via email/dashboard

**Register Shows Inactive/Suspended/Expired**
1. Set `credential.verification_status = 'rejected'`
2. Set `credential.verification_notes` with reason
3. Downgrade `listing.verification_level`
4. Log `audit_event` with details
5. Notify advisor with required actions

---

### Expiry Handling

Licences with expiry dates:

```
expires_at = 2025-06-30

30 days before:
  → Create re-verification task
  → Notify advisor: "Your licence expires soon"

7 days before:
  → Escalate task priority
  → Reminder notification

On expiry:
  → Set verification_status = 'expired'
  → Downgrade verification_level
  → Notify advisor
```

---

### Verification Impact on Ranking

* Unverified listings can appear, but get a **ranking penalty**
* "Verified" badge is a meaningful conversion lever
* Tie-breakers:
  1. Licence Verified
  2. Fast response time
  3. Higher profile completeness
  4. Verified reviews

---

## Implementation Checklist

### MVP (Week 1-2)

- [ ] Claim flow + proof-of-control (phone OTP OR website code)
- [ ] Admin approve/deny workflow
- [ ] ABN verification via ABR API
- [ ] Licence verification = admin checklist + stored evidence
- [ ] Add `next_verification_at` to credential table
- [ ] Create scheduled job to generate re-verification tasks
- [ ] Build admin queue for pending verifications
- [ ] Add badge tooltip with verification date

### V2 (Week 3-4)

- [ ] Add per-state property licence link shortcuts
- [ ] Add ASIC PRS + FAR link shortcuts in admin view
- [ ] Verification level badge logic + ranking boost
- [ ] Integrate ABR API for ABN verification
- [ ] Implement auto-expiry for overdue credentials
- [ ] Add advisor self-service "request re-verification"

---

## Compliance Notes

- Always store evidence of verification (screenshots, API responses)
- Never claim "verified" without checking the source
- If register is unavailable, don't fail-open — mark as "pending"
- Consider professional indemnity implications of displaying badges
